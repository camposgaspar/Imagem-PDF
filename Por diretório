from msgtopdf.msgtopdf import Msgtopdf
from pathlib import Path

import os

pasta = "a"
n = 0
ignorar = {"MSG"}

local_doc = input(r"Onde est√° o arquivo?")
os.chdir(local_doc)

destino = os.path.join(local_doc, "MSG")

if "MSG" in os.listdir(local_doc):
    pass
else:
    os.makedirs(destino)

lista_docs = [x for x in os.listdir(local_doc) if x not in ignorar]


def numero_docs():
    x = int(len(lista_docs))
    return x


print(local_doc)
os.system("msg2pdf -d " + local_doc)

for i in range(0, numero_docs()+10):
    print(i)

    os.chdir(local_doc)
    selecionado = os.listdir(local_doc)[n]
    print(selecionado)
    pdf_pasta = local_doc + "\\" + selecionado
    print(pdf_pasta)

    if selecionado.endswith('.msg'):
        print('msg')
        pass
    elif selecionado == destino:
        pass
    else:

        os.chdir(pdf_pasta)
        pdf_sel = pdf_pasta + '\\' + selecionado + '.pdf'
        print(pdf_sel)
        os.rename(pdf_sel, destino + '\\' + selecionado + ".pdf")
        print(destino + '\\' + selecionado)
    n += 1
